var ngRepeatInfinity;
(function (ngRepeatInfinity) {
    var utils;
    (function (utils) {
        var AngularDirectiveBaseClass = (function () {
            function AngularDirectiveBaseClass() {
                this.link = {
                    pre: this.preLink.bind(this),
                    post: this.postLink.bind(this)
                };
                this.compile = this.unboundCompile.bind(this);
            }
            AngularDirectiveBaseClass.prototype.unboundCompile = function ($el, $attr, transclude) {
                return this.link;
            };
            ;
            AngularDirectiveBaseClass.prototype.preLink = function ($scope, $el, $attr, controller, $transclude) { };
            AngularDirectiveBaseClass.prototype.postLink = function ($scope, $el, $attr, controller, $transclude) { };
            return AngularDirectiveBaseClass;
        })();
        utils.AngularDirectiveBaseClass = AngularDirectiveBaseClass;
        var uid = 0;
        utils.nextUid = function () {
            return ++uid;
        };
        function createMap() {
            return Object.create(null);
        }
        utils.createMap = createMap;
        function getBlockNodes(nodes) {
            // TODO(perf): update `nodes` instead of creating a new object?
            var node = nodes[0];
            var endNode = nodes[nodes.length - 1];
            var blockNodes;
            for (var i = 1; node !== endNode && (node = node.nextSibling); i++) {
                if (blockNodes || nodes[i] !== node) {
                    if (!blockNodes) {
                        blockNodes = angular.element([].slice.call(nodes, 0, i));
                    }
                    blockNodes.push(node);
                }
            }
            return blockNodes || nodes;
        }
        utils.getBlockNodes = getBlockNodes;
        utils.updateScope = function (scope, index, valueIdentifier, value, keyIdentifier, key, arrayLength) {
            // TODO(perf): generate setters to shave off ~40ms or 1-1.5%
            scope[valueIdentifier] = value;
            if (keyIdentifier)
                scope[keyIdentifier] = key;
            scope.$index = index;
            scope.$first = (index === 0);
            scope.$last = (index === (arrayLength - 1));
            scope.$middle = !(scope.$first || scope.$last);
            // jshint bitwise: false
            scope.$odd = !(scope.$even = (index & 1) === 0);
            // jshint bitwise: true
        };
        utils.getBlockStart = function (block) {
            return block.clone[0];
        };
        utils.getBlockEnd = function (block) {
            return block.clone[block.clone.length - 1];
        };
        utils.hashKey = function (obj) {
            var objType = typeof obj;
            var key;
            if (objType == 'object' && obj !== null) {
                if (typeof (key = obj.$$hashKey) == 'function') {
                    // must invoke on object to keep the right this
                    key = obj.$$hashKey();
                }
                else if (key === undefined) {
                    key = obj.$$hashKey = utils.nextUid();
                }
            }
            else {
                key = obj;
            }
            return objType + ':' + key;
        };
        function isWindow(obj) {
            return obj && obj.document && obj.location && obj.alert && obj.setInterval;
        }
        utils.isWindow = isWindow;
        ;
        function isArrayLike(obj) {
            if (obj == null || isWindow(obj)) {
                return false;
            }
            var length = obj.length;
            if (obj.nodeType === 1 && length) {
                return true;
            }
            return angular.isArray(obj) || !angular.isFunction(obj) && (length === 0 || typeof length === "number" && length > 0 && (length - 1) in obj);
        }
        utils.isArrayLike = isArrayLike;
        ;
    })(utils = ngRepeatInfinity.utils || (ngRepeatInfinity.utils = {}));
})(ngRepeatInfinity || (ngRepeatInfinity = {}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLnRzIl0sIm5hbWVzIjpbIm5nUmVwZWF0SW5maW5pdHkiLCJuZ1JlcGVhdEluZmluaXR5LnV0aWxzIiwibmdSZXBlYXRJbmZpbml0eS51dGlscy5Bbmd1bGFyRGlyZWN0aXZlQmFzZUNsYXNzIiwibmdSZXBlYXRJbmZpbml0eS51dGlscy5Bbmd1bGFyRGlyZWN0aXZlQmFzZUNsYXNzLmNvbnN0cnVjdG9yIiwibmdSZXBlYXRJbmZpbml0eS51dGlscy5Bbmd1bGFyRGlyZWN0aXZlQmFzZUNsYXNzLnVuYm91bmRDb21waWxlIiwibmdSZXBlYXRJbmZpbml0eS51dGlscy5Bbmd1bGFyRGlyZWN0aXZlQmFzZUNsYXNzLnByZUxpbmsiLCJuZ1JlcGVhdEluZmluaXR5LnV0aWxzLkFuZ3VsYXJEaXJlY3RpdmVCYXNlQ2xhc3MucG9zdExpbmsiLCJuZ1JlcGVhdEluZmluaXR5LnV0aWxzLmNyZWF0ZU1hcCIsIm5nUmVwZWF0SW5maW5pdHkudXRpbHMuZ2V0QmxvY2tOb2RlcyIsIm5nUmVwZWF0SW5maW5pdHkudXRpbHMuaXNXaW5kb3ciLCJuZ1JlcGVhdEluZmluaXR5LnV0aWxzLmlzQXJyYXlMaWtlIl0sIm1hcHBpbmdzIjoiQUFBQSxBQUNBLHVDQUR1QztBQUN2QyxJQUFPLGdCQUFnQixDQTZHdEI7QUE3R0QsV0FBTyxnQkFBZ0I7SUFBQ0EsSUFBQUEsS0FBS0EsQ0E2RzVCQTtJQTdHdUJBLFdBQUFBLEtBQUtBLEVBQUNBLENBQUNBO1FBRS9CQztZQUVJQztnQkFDRUMsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0E7b0JBQ1ZBLEdBQUdBLEVBQUVBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLElBQUlBLENBQUNBLElBQUlBLENBQUNBO29CQUM1QkEsSUFBSUEsRUFBRUEsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7aUJBQy9CQSxDQUFDQTtnQkFDRkEsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBR0EsSUFBSUEsQ0FBQ0Es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akNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBO1lBQ2RBLENBQUNBO1lBRURBLE1BQU1BLENBQUNBLE9BQU9BLENBQUNBLE9BQU9BLENBQUNBLEdBQUdBLENBQUNBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLFVBQVVBLENBQUNBLEdBQUdBLENBQUNBLElBQUlBLENBQ3pEQSxNQUFNQSxLQUFLQSxDQUFDQSxJQUFJQSxPQUFPQSxNQUFNQSxLQUFLQSxRQUFRQSxJQUFJQSxNQUFNQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxDQUFDQSxJQUFJQSxHQUFHQSxDQUM5RUEsQ0FBQ0E7UUFDTkEsQ0FBQ0E7UUFkZVQsaUJBQVdBLGNBYzFCQSxDQUFBQTtRQUFBQSxDQUFDQTtJQUNKQSxDQUFDQSxFQTdHdUJELEtBQUtBLEdBQUxBLHNCQUFLQSxLQUFMQSxzQkFBS0EsUUE2RzVCQTtBQUFEQSxDQUFDQSxFQTdHTSxnQkFBZ0IsS0FBaEIsZ0JBQWdCLFFBNkd0QiIsImZpbGUiOiJ1dGlscy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJyZWZlcmVuY2UuZC50c1wiIC8+XHJcbm1vZHVsZSBuZ1JlcGVhdEluZmluaXR5LnV0aWxzIHtcclxuXHJcbmV4cG9ydCBjbGFzcyBBbmd1bGFyRGlyZWN0aXZlQmFzZUNsYXNzIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgdGhpcy5saW5rID0ge1xyXG4gICAgICAgIHByZTogdGhpcy5wcmVMaW5rLmJpbmQodGhpcyksXHJcbiAgICAgICAgcG9zdDogdGhpcy5wb3N0TGluay5iaW5kKHRoaXMpXHJcbiAgICAgIH07XHJcbiAgICAgIHRoaXMuY29tcGlsZSA9IHRoaXMudW5ib3VuZENvbXBpbGUuYmluZCh0aGlzKTtcclxuXHJcbiAgICB9XHJcbiAgICBwdWJsaWMgbGluazogbmcuSURpcmVjdGl2ZVByZVBvc3Q7XHJcbiAgICBwdWJsaWMgY29tcGlsZTogbmcuSURpcmVjdGl2ZUNvbXBpbGVGbjtcclxuXHJcbiAgICBwdWJsaWMgdW5ib3VuZENvbXBpbGUoJGVsOiBuZy5JQXVnbWVudGVkSlF1ZXJ5LCAkYXR0cjogbmcuSUF0dHJpYnV0ZXMsIHRyYW5zY2x1ZGU6IG5nLklUcmFuc2NsdWRlRnVuY3Rpb24pOiBuZy5JRGlyZWN0aXZlUHJlUG9zdCB7XHJcbiAgICAgIHJldHVybiB0aGlzLmxpbms7XHJcbiAgICB9O1xyXG4gICAgcHVibGljIHByZUxpbmsoJHNjb3BlOiBuZy5JU2NvcGUsICRlbD86IG5nLklBdWdtZW50ZWRKUXVlcnksICRhdHRyPzogbmcuSUF0dHJpYnV0ZXMsIGNvbnRyb2xsZXI/OiB7fSwgJHRyYW5zY2x1ZGU/OiBuZy5JVHJhbnNjbHVkZUZ1bmN0aW9uKTogdm9pZCB7IH1cclxuICAgIHB1YmxpYyBwb3N0TGluaygkc2NvcGU6IG5nLklTY29wZSwgJGVsPzogbmcuSUF1Z21lbnRlZEpRdWVyeSwgJGF0dHI/OiBuZy5JQXR0cmlidXRlcywgY29udHJvbGxlcj86IHt9LCAkdHJhbnNjbHVkZT86IG5nLklUcmFuc2NsdWRlRnVuY3Rpb24pOiB2b2lkIHsgfVxyXG4gIH1cclxuXHJcblxyXG5cclxuICB2YXIgdWlkID0gMDtcclxuICBleHBvcnQgdmFyIG5leHRVaWQgPSBmdW5jdGlvbigpOiBhbnkge1xyXG4gICAgcmV0dXJuICsrdWlkO1xyXG4gIH07XHJcblxyXG4gIGV4cG9ydCBmdW5jdGlvbiBjcmVhdGVNYXAoKSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICB9XHJcblxyXG4gIGV4cG9ydCBmdW5jdGlvbiBnZXRCbG9ja05vZGVzKG5vZGVzOiBhbnkpOiBhbnkge1xyXG4gICAgLy8gVE9ETyhwZXJmKTogdXBkYXRlIGBub2Rlc2AgaW5zdGVhZCBvZiBjcmVhdGluZyBhIG5ldyBvYmplY3Q/XHJcbiAgICB2YXIgbm9kZSA9IG5vZGVzWzBdO1xyXG4gICAgdmFyIGVuZE5vZGUgPSBub2Rlc1tub2Rlcy5sZW5ndGggLSAxXTtcclxuICAgIHZhciBibG9ja05vZGVzOiBhbnk7XHJcblxyXG4gICAgZm9yICh2YXIgaSA9IDE7IG5vZGUgIT09IGVuZE5vZGUgJiYgKG5vZGUgPSBub2RlLm5leHRTaWJsaW5nKTsgaSsrKSB7XHJcbiAgICAgIGlmIChibG9ja05vZGVzIHx8IG5vZGVzW2ldICE9PSBub2RlKSB7XHJcbiAgICAgICAgaWYgKCFibG9ja05vZGVzKSB7XHJcbiAgICAgICAgICBibG9ja05vZGVzID0gYW5ndWxhci5lbGVtZW50KFtdLnNsaWNlLmNhbGwobm9kZXMsIDAsIGkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYmxvY2tOb2Rlcy5wdXNoKG5vZGUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGJsb2NrTm9kZXMgfHwgbm9kZXM7XHJcbiAgfVxyXG5cclxuICBleHBvcnQgdmFyIHVwZGF0ZVNjb3BlID0gKHNjb3BlOiBuZy5JU2NvcGV8YW55LCBpbmRleDogbnVtYmVyLCB2YWx1ZUlkZW50aWZpZXI6IHN0cmluZywgdmFsdWU6IE9iamVjdCwga2V5SWRlbnRpZmllcjogc3RyaW5nLCBrZXk6IHN0cmluZywgYXJyYXlMZW5ndGg6IG51bWJlcikgPT4ge1xyXG4gICAgLy8gVE9ETyhwZXJmKTogZ2VuZXJhdGUgc2V0dGVycyB0byBzaGF2ZSBvZmYgfjQwbXMgb3IgMS0xLjUlXHJcbiAgICBzY29wZVt2YWx1ZUlkZW50aWZpZXJdID0gdmFsdWU7XHJcbiAgICBpZiAoa2V5SWRlbnRpZmllcikgc2NvcGVba2V5SWRlbnRpZmllcl0gPSBrZXk7XHJcbiAgICBzY29wZS4kaW5kZXggPSBpbmRleDtcclxuICAgIHNjb3BlLiRmaXJzdCA9IChpbmRleCA9PT0gMCk7XHJcbiAgICBzY29wZS4kbGFzdCA9IChpbmRleCA9PT0gKGFycmF5TGVuZ3RoIC0gMSkpO1xyXG4gICAgc2NvcGUuJG1pZGRsZSA9ICEoc2NvcGUuJGZpcnN0IHx8IHNjb3BlLiRsYXN0KTtcclxuICAgIC8vIGpzaGludCBiaXR3aXNlOiBmYWxzZVxyXG4gICAgc2NvcGUuJG9kZCA9ICEoc2NvcGUuJGV2ZW4gPSAoaW5kZXggJiAxKSA9PT0gMCk7XHJcbiAgICAvLyBqc2hpbnQgYml0d2lzZTogdHJ1ZVxyXG4gIH07XHJcblxyXG4gIGV4cG9ydCB2YXIgZ2V0QmxvY2tTdGFydCA9IChibG9jazogYW55KSA9PiB7XHJcbiAgICByZXR1cm4gYmxvY2suY2xvbmVbMF07XHJcbiAgfTtcclxuXHJcbiAgZXhwb3J0IHZhciBnZXRCbG9ja0VuZCA9IChibG9jazogYW55KSA9PiB7XHJcbiAgICByZXR1cm4gYmxvY2suY2xvbmVbYmxvY2suY2xvbmUubGVuZ3RoIC0gMV07XHJcbiAgfTtcclxuXHJcbiAgZXhwb3J0IHZhciBoYXNoS2V5ID0gKG9iajogYW55KSA9PiB7XHJcbiAgICB2YXIgb2JqVHlwZSA9IHR5cGVvZiBvYmo7XHJcbiAgICB2YXIga2V5OiAoKCkgPT4gc3RyaW5nKSB8c3RyaW5nO1xyXG5cclxuICAgIGlmIChvYmpUeXBlID09ICdvYmplY3QnICYmIG9iaiAhPT0gbnVsbCkge1xyXG4gICAgICBpZiAodHlwZW9mIChrZXkgPSBvYmouJCRoYXNoS2V5KSA9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgLy8gbXVzdCBpbnZva2Ugb24gb2JqZWN0IHRvIGtlZXAgdGhlIHJpZ2h0IHRoaXNcclxuICAgICAgICBrZXkgPSBvYmouJCRoYXNoS2V5KCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBrZXkgPSBvYmouJCRoYXNoS2V5ID0gbmV4dFVpZCgpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBrZXkgPSBvYmo7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG9ialR5cGUgKyAnOicgKyBrZXk7XHJcbiAgfTtcclxuICBcclxuICBleHBvcnQgZnVuY3Rpb24gaXNXaW5kb3cob2JqOiBhbnkpIHtcclxuICAgIHJldHVybiBvYmogJiYgb2JqLmRvY3VtZW50ICYmIG9iai5sb2NhdGlvbiAmJiBvYmouYWxlcnQgJiYgb2JqLnNldEludGVydmFsO1xyXG4gIH07XHJcblxyXG4gIGV4cG9ydCBmdW5jdGlvbiBpc0FycmF5TGlrZShvYmo6IGFueSkge1xyXG4gICAgaWYgKG9iaiA9PSBudWxsIHx8IGlzV2luZG93KG9iaikpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBsZW5ndGggPSBvYmoubGVuZ3RoO1xyXG5cclxuICAgIGlmIChvYmoubm9kZVR5cGUgPT09IDEgJiYgbGVuZ3RoKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhbmd1bGFyLmlzQXJyYXkob2JqKSB8fCAhYW5ndWxhci5pc0Z1bmN0aW9uKG9iaikgJiYgKFxyXG4gICAgICBsZW5ndGggPT09IDAgfHwgdHlwZW9mIGxlbmd0aCA9PT0gXCJudW1iZXJcIiAmJiBsZW5ndGggPiAwICYmIChsZW5ndGggLSAxKSBpbiBvYmpcclxuICAgICAgKTtcclxuICB9OyAgICBcclxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==